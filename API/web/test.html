<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Test table ternaire artist_album_track</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #121212;
            color: white;
            padding: 20px;
        }

        .album {
            border: 1px solid #333;
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 8px;
            background: #1e1e1e;
        }

        .error {
            color: red;
            font-weight: bold;
        }

        button {
            padding: 10px 15px;
            background: #4CAF50;
            border: none;
            cursor: pointer;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

<h1>Test relation artist_album_track</h1>

<button onclick="testRelation()">Tester la relation</button>

<div id="results"></div>

<script>
async function testRelation() {

    const container = document.getElementById("results");
    container.innerHTML = "Chargement...";

    try {
        // 1Ô∏è‚É£ On r√©cup√®re 5 albums
        const albumsResponse = await fetch("http://127.0.0.1:8000/albums?limit=5");
        const albumsData = await albumsResponse.json();

        container.innerHTML = "";

        for (const album of albumsData.results) {

            const div = document.createElement("div");
            div.className = "album";

            div.innerHTML = `<h3>Album: ${album.album_title} (ID: ${album.album_id})</h3>`;

            // 2Ô∏è‚É£ On interroge la relation via /albums/{id}/tracks
            const tracksResponse = await fetch(
                `http://127.0.0.1:8000/albums/${album.album_id}/tracks`
            );

            const tracksData = await tracksResponse.json();

            if (tracksData.tracks.length === 0) {
                div.innerHTML += `<p class="error">‚ö†Ô∏è AUCUNE relation trouv√©e dans artist_album_track</p>`;
            } else {
                div.innerHTML += `<p>Relations trouv√©es : ${tracksData.tracks.length}</p>`;
                
                tracksData.tracks.forEach(track => {
                    div.innerHTML += `
                        <p>
                            üéµ ${track.track_title} <br>
                            üë§ Artiste: ${track.artist_name}
                        </p>
                    `;
                });
            }

            container.appendChild(div);
        }

    } catch (error) {
        container.innerHTML = `<p class="error">Erreur : ${error}</p>`;
        console.error(error);
    }
}
</script>

</body>
</html>
