<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <title>API MuSE</title>
        <link rel="stylesheet" href="style.css"/>
    </head>
    <body class="test-api">
        <header>
            <a href="accueil.html"><h2>MuSE</h2></a> 
            <!--<img src="../images/logos/muse.png" alt="MuSE">-->
            <nav>
                <a href="accueil.html">Accueil</a>
                <a href="playlists.html">Playlists</a>
                <a href="preferences.html">Préférences</a>
                <a href="api.html">API</a>
            </nav>
            <button>
                <a href="#contact">Contact</a>
            </button>
        </header>
        <main>
            <h1>Testez l'API !</h1>
            <p>Utilisez cette page pour tester les différents endpoints de l'API MuSE.</p>
            <br>

            <div>
                <label>Endpoint : </label>
                <select id="endpointSelect" onchange="updateUrl()"></select>
            </div>
            <br>
            <div>
                <label>URL : </label>
                <input type="text" id="urlInput" value="http://127.0.0.1:8000/" size="100">
                <br>
                <button onclick="sendRequest()">Envoyer la requête</button>
            </div>

            <hr>

            <div>
                <strong>Status :</strong> <span id="status">En attente</span>
            </div>
            <pre id="result">Les résultats s'afficheront ici...</pre>
        </main>
        <section>
            <h1>Documentation de l'API</h1>
            <p>Ici sont expliqués les différents endpoints de l'API MuSE.</p>
            <br>

            <h2>Endpoints disponibles :</h2>
            <br>
            <h3>GET /tracks</h3>
            <p>Récupère la liste de toutes les tracks disponibles.</p>
            <br>
            <h3>GET /tracks/{id}</h3>
            <p>Récupère les détails d'une track spécifique en utilisant son ID.</p>
            <br>
            <h3>GET /tracks/{id}/recommendations?limit={n}</h3>
            <p>Récupère une liste de recommandations de tracks similaires à la track spécifiée par son ID. Le paramètre "limit" permet de définir le nombre de recommandations à retourner.</p>
            <br>
            <h3>GET /artists?limit={n}&offset={m}</h3>
            <p>Récupère la liste de tous les artistes disponibles, avec pagination. Le paramètre "limit" définit le nombre d'artistes à retourner, tandis que "offset" définit le point de départ pour la pagination.</p>
            <br>
            <h3>GET /artists?name={name}</h3>
            <p>Récupère la liste des artistes dont le nom correspond à la valeur spécifiée dans le paramètre "name".</p>
            <br>
            <h3>GET /artists/{id}/tracks</h3>
            <p>Récupère la liste de toutes les tracks associées à un artiste spécifique en utilisant son ID.</p>
            <br>
            <h3>GET /albums?limit={n}</h3>
            <p>Récupère la liste de tous les albums disponibles, avec pagination. Le paramètre "limit" définit le nombre d'albums à retourner.</p>
            <br>
            <h3>GET /albums/{id}/tracks</h3>
            <p>Récupère la liste de toutes les tracks associées à un album spécifique en utilisant son ID.</p>
            <br>
            <h3>GET /genres</h3>
            <p>Récupère la liste de tous les genres musicaux disponibles.</p>
        </section>
        <footer>
            <div class="titre-footer">
                <h2>MuSE</h2>
            </div>
            <div class="navigation-footer">
                <div>
                    <p>Société</p>
                    <div>
                        <a href="#">À propos de nous</a>
                        <a href="#">Offre d'emploi</a>
                    </div>
                </div>
                <div>
                    <p>Liens utiles</p>
                    <div>
                        <a href="#">Nous contacter</a>
                    </div>
                </div>
                <div>
                    <p>Communauté</p>
                    <div>
                        <a href="#">Développeurs</a>
                    </div>
                </div>
                <div>
                    <p>Légal</p>
                    <div>
                        <a href="#">Mentions légales</a>
                    </div>
                </div>
            </div>
            <div class="barre-separation-footer"></div>
            <div class="fin-footer">
                <div class="reseaux-sociaux-footer">
                    <a href="#"><img src="../images/icones/instagram.avif" alt="Instagram"/></a>
                    <a href="#"><img src="../images/icones/linkedin.avif" alt="LinkedIn"/></a>
                    <a href="#"><img src="../images/icones/github.avif" alt="GitHub"/></a>
                    <a href="#"><img src="../images/icones/facebook.avif" alt="Facebook"/></a>
                </div>
                <p>© 2026 MuSE Français</p>
            </div>
        </footer>    
    </body>
    
    <script>
        const BASE_URL = "http://127.0.0.1:8000";

        // Liste des endpoints
        const endpoints = [
            { label: "Accueil", path: "/" },
            { label: "Toutes les tracks", path: "/tracks" },
            { label: "Track par ID (ex: 1)", path: "/tracks/1" },
            { label: "Recommandations Track (ex: 1)", path: "/tracks/1/recommendations?limit=5" },
            { label: "Tous les artistes", path: "/artists?limit=50&offset=0" },
            { label: "Recherche artiste (ex: Muse)", path: "/artists?name=Muse" },
            { label: "Tracks d'un artiste (ex: 1)", path: "/artists/1/tracks" },
            { label: "Tous les albums", path: "/albums?limit=50" },
            { label: "Tracks d'un album (ex: 1)", path: "/albums/1/tracks" },
            { label: "Tous les genres", path: "/genres" }
        ];

        // Initialisation de la liste déroulante
        const select = document.getElementById('endpointSelect');
        const input = document.getElementById('urlInput');
        const statusSpan = document.getElementById('status');
        const resultPre = document.getElementById('result');

        // Remplir le select
        endpoints.forEach(ep => {
            const option = document.createElement('option');
            option.value = ep.path;
            option.text = ep.label;
            select.appendChild(option);
        });

        // Mettre à jour l'input quand on change le select
        function updateUrl() {
            input.value = BASE_URL + select.value;
        }

        // Fonction d'envoi
        async function sendRequest() {
            const url = input.value;
            statusSpan.textContent = "Chargement...";
            resultPre.textContent = "";

            try {
                const response = await fetch(url);
                statusSpan.textContent = response.status + " " + response.statusText;
                
                const data = await response.json();
                // Affichage formaté (indentation de 4 espaces)
                resultPre.textContent = JSON.stringify(data, null, 4);
            } catch (error) {
                statusSpan.textContent = "Erreur";
                resultPre.textContent = "Impossible de contacter l'API : " + error;
            }
        }
    </script>
</html>